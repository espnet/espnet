# YO Restorer

**YO Restorer** — это пакет для восстановления буквы "ё" в русском тексте, где это необходимо. Представляет собой словари со словами с буквой "ё" и обёртку для работы с ними.

**Особенности:**

- восстановление буквы "ё" в русском тексте
- по умолчанию выполняется замена "е" на "ё" только в однозначных (бесспорных) случаях
- поддерживается замена "е" на "ё" в неоднозначных (спорных) случаях (на свой страх и риск!)
- поддерживаются слова, в которых буква "ё" пишется только при написании слова с большой или маленькой буквы (например, "киёв" (от "кий") и "Киев" (город))
- предусмотрен режим полной нечувствительности к регистру букв (полезно для работы с базами ФИО)
- исправление неправильно поставленных "ё" (например, "бёреза" -> "берёза")
- восстановление нескольких букв "ё" в одном слове (например, "трехпролетный" -> "трёхпролётный", "Телегеновы" -> "Тёлёгёновы")
- корректная обработка сокращений (известно только сокращение с "мед.", например "мед. учреждение")
- поддержка дополнительного пользовательского словаря, который будет дополнять и перезаписывать слова во встроенном словаре однозначных слов

В качестве примера использовались: [eyo-kernel](https://github.com/e2yo/eyo-kernel), [yoficator](https://github.com/link2xt/yoficator) и [karamzin](https://github.com/kalashnikovisme/karamzin).

## Зависимости

**Отсутствуют.** Пакет использует только стандартные Python библиотеки. Стабильная работа гарантируется в Python 3.6-3.8.

## Использование

Инициализация объекта класса:

```python
from yo_restorer import YoRestorer

# f_name_add_dict - имя дополнительного пользовательского словаря, необязательно
f_name_add_dict = 'text_preparation/yo_restorer/additional_yo_dict.txt'  
yo_restorer = YoRestorer(f_name_add_dict=f_name_add_dict)
```

Восстановление буквы "ё" только в однозначных (бесспорных) случаях:

```python
print(yo_restorer.restore('Елочка и бёреза пойдут на трехпролетный дом!',
                          use_unsafe_dict=False,
                          ignore_word_characteristics=False))
```

Восстановление буквы "ё" так же и в неоднозначных (спорных) случаях:

```python
print(yo_restorer.restore('Телегенов Клева Очеров - акушер в березневском центре',
                          use_unsafe_dict=True,
                          ignore_word_characteristics=False))
```

Восстановление буквы "ё" в неоднозначных случаях с нечувствительностью к регистру букв:

```python
print(yo_restorer.restore('головенков КЛЕВА очЕРов и аКсЕнОв ПЕТР АрТеМоВиЧ',
                          use_unsafe_dict=True,
                          ignore_word_characteristics=True))
```

Код проекта содержит комментарии и docstrings в каждом классе и методе. Всю остальную информацию можно посмотреть в [yo_restorer.py](https://gitlab.twin24.ai/ai/tts/taco_tts/tree/master/text_preparation/yo_restorer/yo_restorer.py) и [dictionary.py](https://gitlab.twin24.ai/ai/tts/taco_tts/tree/master/text_preparation/yo_restorer/dictionary.py).

## Словари

В проекте используются **словари 2 видов:** с однозначными (бесспорными, safe) и неоднозначными (спорными, unsafe) словами. Словарь **однозначных слов** содержит **107.351 словоформ**, а словарь **неоднозначных слов** — **33.592 словоформ.** Словари находятся в папке [dicts](https://gitlab.twin24.ai/ai/tts/taco_tts/tree/master/text_preparation/yo_restorer/dicts).

Конечные словари, которые поставляются вместе с пакетом, созданы в большей части из словарей от проектов [eyo-kernel](https://github.com/e2yo/eyo-kernel), [yoficator](https://github.com/link2xt/yoficator) и [karamzin](https://github.com/kalashnikovisme/karamzin). Для этого предусмотрен скрипт [creating_initial_dictionaries.py](https://gitlab.twin24.ai/ai/tts/taco_tts/tree/master/text_preparation/yo_restorer/creating_initial_dictionaries.py).

Словари являются простыми **текстовыми файлами**, где **на 1 строке** может быть **только 1 слово с буквой "ё".** Поддерживается следующая **разметка:**

1. Слово начинается с нижнего подчёркивания `"_"`: восстановление "ё" только при написании слова с маленькой/строчной буквы (например, "_киёв")
2. Слово начинается с большой/заглавной буквы: восстановление "ё" только при написании слова с большой/заглавной буквы (например, "Будённовск")
3. Слово начинается с маленькой/строчной буквы: восстановление "ё" в любом случае (например, "четырёхядерный")
4. В конце слова в скобках через символ `"|"` можно перечислить окончания для этого слова, допускается "пустое" окончание (например, "увёртлив(|а|ая)" при чтении словаря раскроется в "увёртлив", "увёртлива", "увёртливая")
5. Текст после символа решётки `"#"` принимается за комментарий и игнорируется (например, "_киёв # от слова кий, а Киев - город")

**Примечание:** в словарях записываются только слова с проставленной буквой "ё"!

## Авторы

- Клим Владислав (klim@twin24.ai, Телеграм: @vladis_kl, [LinkedIn](https://www.linkedin.com/in/vladklim/))
