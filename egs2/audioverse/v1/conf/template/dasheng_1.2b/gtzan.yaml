unused_parameters: true
init: xavier_normal

batch_type: folded
shuffle_within_batch: false

valid_batch_size: 16
batch_size: 8 # 16
max_epoch: 160

accum_grad: 1
grad_clip: 1

optim: adamw
optim_conf:
    lr: 3.0e-5
    weight_decay: 1.0e-2
    betas: [0.9, 0.98]

scheduler: CosineAnnealingWarmupRestarts
scheduler_conf:
    first_cycle_steps: 15000
    warmup_steps: 1500
    max_lr: 3.0e-5
    min_lr: 5.0e-6

patience: none
best_model_criterion:
-   - valid
    - acc
    - max
keep_nbest_models: 1
use_amp: false  # whether to use automatic mixed precision
num_att_plot: 0
num_workers: 2 # dataloader workers

frontend: none
input_size: 1
normalize: none

encoder: dasheng
encoder_conf:
    model_name: DASHENG_MODEL_NAME
    roll_augment: true
    roll_interval: 1 # 16000
    specaug_config:
        apply_time_warp: true
        apply_freq_mask: false
        apply_time_mask: true
        time_mask_width_ratio_range:
        - 0
        - 0.06
        num_time_mask: 1 

model_conf:
    classification_type: multi-class
    lsm_weight: 0.1  # label smoothing weight, per label
